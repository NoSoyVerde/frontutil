<div class="blog-list-container">
  <h1>Buscar Blogs</h1>
  
  <div class="search-form">
    <div class="form-group">
      <label for="searchType">Buscar por:</label>
      <select 
        id="searchType" 
        [(ngModel)]="searchType" 
        class="form-control">
        <option value="etiquetas">Etiquetas</option>
        <option value="titulo">Título</option>
        <option value="contenido">Contenido</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="searchValue">Valor:</label>
      <input 
        type="text" 
        id="searchValue" 
        [(ngModel)]="searchValue"
        (keyup.enter)="search()"
        class="form-control"
        placeholder="Introduce el valor de búsqueda">
    </div>
    
    <button (click)="search()" class="btn btn-primary" [disabled]="loading()">
      @if (loading()) {
        Buscando...
      } @else {
        Buscar
      }
    </button>

    @if (searchValue()) {
      <button (click)="clearSearch()" class="btn btn-secondary">Limpiar</button>
    }
    
    <a routerLink="/blogs/new" class="btn btn-success">Crear Nuevo Blog</a>
  </div>

  @if (error()) {
    <div class="alert alert-danger">{{ error() }}</div>
  }

  @if (loading()) {
    <div class="loading">Cargando blogs...</div>
  }

  @if (blogs().length > 0) {
    <div class="blogs-grid">
      @for (blog of blogs(); track blog.id) {
        <div class="blog-card">
          <h3>{{ blog.titulo }}</h3>
          <p class="blog-category">Etiquetas: {{ blog.etiquetas }}</p>
          <p class="blog-content">{{ blog.contenido.substring(0, 150) }}...</p>
          <div class="blog-dates">
            <small>Creado: {{ blog.fechaCreacion }}</small>
            @if (blog.fechaModificacion) {
              <small>Modificado: {{ blog.fechaModificacion }}</small>
            }
          </div>
          <div class="blog-actions">
            <a [routerLink]="['/blogs', blog.id]" class="btn btn-info">Ver Detalle</a>
            <a [routerLink]="['/blogs/edit', blog.id]" class="btn btn-warning">Editar</a>
            <button (click)="deleteBlog(blog.id!)" class="btn btn-danger">Eliminar</button>
          </div>
        </div>
      }
    </div>

    <!-- Botonera de Paginación -->
    <div class="pagination-container">
      <div class="pagination-info">
        <span>Mostrando {{ blogs().length }} de {{ totalElements() }} blogs</span>
      </div>
      
      <div class="pagination">
        <!-- Botón Primera Página -->
        <button 
          (click)="firstPage()" 
          [disabled]="currentPage() === 0 || loading()"
          class="btn-page btn-nav"
          title="Primera página">
          ⟪
        </button>
        
        <!-- Botón Anterior -->
        <button 
          (click)="previousPage()" 
          [disabled]="currentPage() === 0 || loading()"
          class="btn-page btn-nav"
          title="Anterior">
          ‹
        </button>

        <!-- Números de Página -->
        @for (pageNum of getPageNumbers(); track $index) {
          @if (pageNum === null) {
            <span class="page-dots">...</span>
          } @else {
            <button
              (click)="goToPage(pageNum)"
              [class.active]="pageNum === currentPage()"
              [disabled]="loading()"
              class="btn-page btn-number"
              [title]="'Página ' + (pageNum + 1)">
              {{ pageNum + 1 }}
            </button>
          }
        }

        <!-- Botón Siguiente -->
        <button 
          (click)="nextPage()" 
          [disabled]="currentPage() >= totalPages() - 1 || loading()"
          class="btn-page btn-nav"
          title="Siguiente">
          ›
        </button>
        
        <!-- Botón Última Página -->
        <button 
          (click)="lastPage()" 
          [disabled]="currentPage() >= totalPages() - 1 || loading()"
          class="btn-page btn-nav"
          title="Última página">
          ⟫
        </button>
      </div>
    </div>

  } @else if (!loading() && !error()) {
    <div class="no-results">
      <p>No hay resultados. Realiza una búsqueda para ver blogs.</p>
    </div>
  }
</div>
